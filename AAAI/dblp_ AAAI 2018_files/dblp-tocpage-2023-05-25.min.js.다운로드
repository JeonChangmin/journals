if(!window.buckets)throw"dblp-tocpage.js: buckets.js library has not been loaded.";if(!window.encoder)throw"dblp-tocpage.js: encoder.js library has not been loaded.";if(!window.dblp)throw"dblp-tocpage.js: dblp.js has not been loaded.";dblp.tocpage=dblp.tocpage||{};dblp.tocpage.MAX_SIMILAR_NAMES_TO_SHOW=10;dblp.tocpage.MAX_OPTIONS_TO_SHOW=10;dblp.tocpage.OPTIONS_TO_SHOW_GROWTH_RATE=4;(function(mod,undefined){function RefineState(){this.toc=$("#headline").data("bhtkey")+".bht";this.queryInput=null;this.authorSet=new buckets.Set;this.instSet=new buckets.Set;this.accessSet=new buckets.Set;this.reset=function(){this.authorSet.clear();this.instSet.clear();this.accessSet.clear()};this.getPublQuery=function(){let result="toc:"+this.toc+":";if(!this.authorSet.isEmpty()){let items=this.authorSet.toArray();for(let i=0;i<items.length;i++){result+=" author:"+items[i]+":"}}if(!this.instSet.isEmpty()){let items=this.instSet.toArray();for(let i=0;i<items.length;i++){result+=" inst:"+items[i]+":"}}if(!this.accessSet.isEmpty()){let items=this.accessSet.toArray();for(let i=0;i<items.length;i++){result+=" access:"+items[i]+":"}}if(this.queryInput!==null){let terms=encoder.htmlDecode(this.queryInput.val().trim());if(terms.length>0){terms=terms.split(/\s+/);for(let i=0;i<terms.length;i++){result+=" "+terms[i]}}}return result};this.isActive=function(){if(this.authorSet.isEmpty()&&this.instSet.isEmpty()&&this.accessSet.isEmpty()&&(this.queryInput===null||this.queryInput.val().trim().length==0)){return false}else return true}}mod.RS=new RefineState;function urldata(url,data){let result=url+"?";for(let prop in data){result+=prop+"="+data[prop]+"&"}result=result.substring(0,result.length-1);return encodeURI(result)}function numWithCommas(input){if(typeof input=="string")str=input;else str=input.toString();return str.replace(/\B(?=(\d{3})+(?!\d))/g,",")}function clearLockBreakers(){let panel=$("#tocpage-refine");let lockBreakers=panel.data("lockBreakers").toArray();if(lockBreakers.length>0)console.debug("clearing lock breakers",lockBreakers);for(let i=0;i<lockBreakers.length;i++)clearTimeout(lockBreakers[i]);panel.data("lockBreakers").clear()}function updateTopicCloud(){console.debug("start updating topic cloud");let results=$(".refine-by.topic-cloud .wordcloud");let url=dblp.CS_CONCEPTS_INCLUDE_URL;let data={q:mod.RS.getPublQuery(),c:12};console.debug("loading: ",urldata(url,data));results.load(urldata(url,data)+" .wordcloud>div",function(responseText,textStatus,xmlHttpRequest){if(textStatus=="error"){results.append('<span class="warning">service temporarily not available</span>');console.error("concepts: ["+xmlHttpRequest.status+"] "+xmlHttpRequest.statusText)}else if(results.find("div").length==0){results.append("<em>no options</em>")}else{}console.info("done updating topic cloud")})}function updateRefineByAuthor(factor){if(typeof factor==="undefined")factor=1;console.debug("start updating refine-by-author options");var panel=$("#tocpage-refine");var byAuthor=panel.find(".refine-by.author");var options=byAuthor.find(".options");var moreOptions=byAuthor.find(".more-options");var noOptions=byAuthor.find(".no-options");var waiting=byAuthor.find(".waiting");var error=byAuthor.find(".error");options.hide();moreOptions.hide();noOptions.hide();waiting.show();error.hide();byAuthor.show();var lockBreaker=setTimeout(function(){console.error("author: received timeout while calling ajax");clearLockBreakers();reset()},7e3);panel.data("lockBreakers").add(lockBreaker);var url=dblp.CS_PUBLS_API_URL;var data={q:mod.RS.getPublQuery(),compl:"author",p:2,h:0,c:factor*dblp.tocpage.MAX_OPTIONS_TO_SHOW+mod.RS.authorSet.size()+1,format:"jsonp"};console.debug("calling:",urldata(url,data));$.ajax({url:url,type:"GET",data:data,dataType:"jsonp"}).done(function(data,textStatus,jqXHR){var completion=data.result.completions.c;var total=parseInt(data.result.completions["@total"]);var sent=parseInt(data.result.completions["@sent"]);if(sent==1)completion=[completion];console.info("retrieving",sent,"of",total,"hits");console.debug("result",data.result);options.empty();var countOf={};for(var i=0;i<sent;i++){var facet=completion[i].text.substring(":facet:author:".length).trim();var count=completion[i]["@dc"];countOf[facet]=parseInt(count)}var val=function(x){return countOf[x]?countOf[x]:0};constraint=mod.RS.authorSet.toArray();constraint.sort(function(a,b){return val(a)>val(b)?-1:val(a)<val(b)?1:0});for(var i=0;i<constraint.length;i++){var facet=constraint[i].trim();var label=facet.replace(/_/g," ").trim();if(label.startsWith("0")){continue}else if(label.match(/.*\s\d\d\d\d/)){label=label.substring(0,label.length-4)+'<span class="homonym-nr">'+label.substring(label.length-4)+"</span>"}var count=val(facet);options.append('<li class="del"><img class="mark" src="'+dblp.BASE_URL+'/img/del-mark.12x12.png">'+'<button class="text selected" value="'+facet+'">'+unescape(label)+"&nbsp;("+numWithCommas(count)+")&nbsp;&#10003;</button></li>")}var maxOpt=factor*dblp.tocpage.MAX_OPTIONS_TO_SHOW+1;if(maxOpt>sent)maxOpt=sent;for(var i=0;i<maxOpt;i++){var facet=completion[i].text.substring(":facet:author:".length).trim();var label=facet.replace(/_/g," ").trim();if(label.startsWith("0")){continue}else if(label.match(/.*\s\d\d\d\d/)){label=label.substring(0,label.length-4)+'<span class="homonym-nr">'+label.substring(label.length-4)+"</span>"}var count=completion[i]["@dc"];if(!mod.RS.authorSet.contains(facet)){options.append('<li class="add"><img class="mark" src="'+dblp.BASE_URL+'/img/add-mark.12x12.png">'+'<button class="text" value="'+facet+'">'+unescape(label)+"&nbsp;("+numWithCommas(count)+")</button></li>")}}options.find("li.add").find("button").click(function(){if(panel.data("queryMutex")){return false}else{var facet=$(this).prop("value");console.debug("clicked",facet);mod.RS.authorSet.add(facet);var success=filter();return success}});options.find("li.del").find("button").click(function(){if(panel.data("queryMutex")){return false}else{var facet=$(this).prop("value");console.debug("clicked",facet);mod.RS.authorSet.remove(facet);var success=filter();return success}});if(!mod.RS.authorSet.isEmpty()||sent>=2){options.show();if(parseInt(total)>maxOpt){var excess=parseInt(total)-sent;var label=numWithCommas(excess)+" more options";if(excess==1)label="1 more option";moreOptions.html('<li class="more"><button class="text"><em>'+label+"</em></button></li>");moreOptions.find("li.more").click(function(){updateRefineByAuthor(dblp.tocpage.OPTIONS_TO_SHOW_GROWTH_RATE*factor)});moreOptions.show()}noOptions.hide()}else{options.hide();moreOptions.hide();noOptions.show()}}).fail(function(jqXHR,textStatus,errorThrown){console.error("author: ["+textStatus+"]",errorThrown);error.show()}).always(function(){console.info("done updating refine-by-author options");waiting.hide();panel.data("lockBreakers").remove(lockBreaker);clearTimeout(lockBreaker)})}function updateRefineByInst(factor){if(typeof factor==="undefined")factor=1;console.debug("start updating refine-by-inst options");var panel=$("#tocpage-refine");var byInst=panel.find(".refine-by.inst");var options=byInst.find(".options");var moreOptions=byInst.find(".more-options");var noOptions=byInst.find(".no-options");var waiting=byInst.find(".waiting");var error=byInst.find(".error");options.hide();moreOptions.hide();noOptions.hide();waiting.show();error.hide();byInst.show();var lockBreaker=setTimeout(function(){console.error("inst: received timeout while calling ajax");clearLockBreakers();reset()},7e3);panel.data("lockBreakers").add(lockBreaker);var url=dblp.CS_PUBLS_API_URL;var data={q:mod.RS.getPublQuery(),compl:"inst",p:2,h:0,c:factor*dblp.tocpage.MAX_OPTIONS_TO_SHOW+mod.RS.instSet.size()+1,format:"jsonp"};console.debug("calling:",urldata(url,data));$.ajax({url:url,type:"GET",data:data,dataType:"jsonp"}).done(function(data,textStatus,jqXHR){var completion=data.result.completions.c;var total=parseInt(data.result.completions["@total"]);var sent=parseInt(data.result.completions["@sent"]);if(sent==1)completion=[completion];console.info("retrieving",sent,"of",total,"hits");console.debug("result",data.result);options.empty();var countOf={};for(var i=0;i<sent;i++){var facet=completion[i].text.substring(":facet:inst:".length).trim();var count=completion[i]["@dc"];countOf[facet]=parseInt(count)}var val=function(x){return countOf[x]?countOf[x]:0};constraint=mod.RS.instSet.toArray();constraint.sort(function(a,b){return val(a)>val(b)?-1:val(a)<val(b)?1:0});for(var i=0;i<constraint.length;i++){var facet=constraint[i].trim();var label=facet.replace(/_/g," ").trim();if(label.match(/.*\s\d\d\d\d/)){label=label.substring(0,label.length-4)+'<span class="homonym-nr">'+label.substring(label.length-4)+"</span>"}var count=val(facet);options.append('<li class="del"><img class="mark" src="'+dblp.BASE_URL+'/img/del-mark.12x12.png">'+'<button class="text selected" value="'+facet+'">'+unescape(label)+"&nbsp;("+numWithCommas(count)+")&nbsp;&#10003;</button></li>")}var maxOpt=factor*dblp.tocpage.MAX_OPTIONS_TO_SHOW+1;if(maxOpt>sent)maxOpt=sent;for(var i=0;i<maxOpt;i++){var facet=completion[i].text.substring(":facet:inst:".length).trim();var label=facet.replace(/_/g," ").trim();if(label.match(/.*\s\d\d\d\d/)){label=label.substring(0,label.length-4)+'<span class="homonym-nr">'+label.substring(label.length-4)+"</span>"}var count=completion[i]["@dc"];if(!mod.RS.instSet.contains(facet)){options.append('<li class="add"><img class="mark" src="'+dblp.BASE_URL+'/img/add-mark.12x12.png">'+'<button class="text" value="'+facet+'">'+unescape(label)+"&nbsp;("+numWithCommas(count)+")</button></li>")}}options.find("li.add").find("button").click(function(){if(panel.data("queryMutex")){return false}else{var facet=$(this).prop("value");console.debug("clicked",facet);mod.RS.instSet.add(facet);var success=filter();return success}});options.find("li.del").find("button").click(function(){if(panel.data("queryMutex")){return false}else{var facet=$(this).prop("value");console.debug("clicked",facet);mod.RS.instSet.remove(facet);var success=filter();return success}});if(!mod.RS.instSet.isEmpty()||sent>=2){options.show();if(parseInt(total)>maxOpt){var excess=parseInt(total)-sent;var label=numWithCommas(excess)+" more options";if(excess==1)label="1 more option";moreOptions.html('<li class="more"><button class="text"><em>'+label+"</em></button></li>");moreOptions.find("li.more").click(function(){updateRefineByInst(dblp.tocpage.OPTIONS_TO_SHOW_GROWTH_RATE*factor)});moreOptions.show()}noOptions.hide()}else{options.hide();moreOptions.hide();noOptions.show()}}).fail(function(jqXHR,textStatus,errorThrown){console.error("inst: ["+textStatus+"]",errorThrown);error.show()}).always(function(){console.info("done updating refine-by-inst options");waiting.hide();panel.data("lockBreakers").remove(lockBreaker);clearTimeout(lockBreaker)})}function updateRefineByAccess(factor){if(typeof factor==="undefined")factor=1;console.debug("start updating refine-by-access options");var panel=$("#tocpage-refine");var byAccess=panel.find(".refine-by.access");var options=byAccess.find(".options");var moreOptions=byAccess.find(".more-options");var noOptions=byAccess.find(".no-options");var waiting=byAccess.find(".waiting");var error=byAccess.find(".error");options.hide();moreOptions.hide();noOptions.hide();waiting.show();error.hide();byAccess.show();var lockBreaker=setTimeout(function(){console.error("access: received timeout while calling ajax");clearLockBreakers();reset()},7e3);panel.data("lockBreakers").add(lockBreaker);var url=dblp.CS_PUBLS_API_URL;var data={q:mod.RS.getPublQuery(),compl:"access",p:2,h:0,c:factor*dblp.tocpage.MAX_OPTIONS_TO_SHOW+mod.RS.accessSet.size()+1,format:"jsonp"};console.debug("calling:",urldata(url,data));$.ajax({url:url,type:"GET",data:data,dataType:"jsonp"}).done(function(data,textStatus,jqXHR){var completion=data.result.completions.c;var total=parseInt(data.result.completions["@total"]);var sent=parseInt(data.result.completions["@sent"]);if(sent==1)completion=[completion];console.info("retrieving",sent,"of",total,"hits");console.debug("result",data.result);options.empty();var countOf={};for(var i=0;i<sent;i++){var facet=completion[i].text.substring(":facet:access:".length).trim();var count=completion[i]["@dc"];countOf[facet]=parseInt(count)}var val=function(x){return countOf[x]?countOf[x]:0};constraint=mod.RS.accessSet.toArray();constraint.sort(function(a,b){return val(a)>val(b)?-1:val(a)<val(b)?1:0});for(var i=0;i<constraint.length;i++){var facet=constraint[i].trim();var label=facet.replace(/_/g," ").trim();if(label.match(/.*\s\d\d\d\d/)){label=label.substring(0,label.length-4)+'<span class="homonym-nr">'+label.substring(label.length-4)+"</span>"}var count=val(facet);options.append('<li class="del"><img class="mark" src="'+dblp.BASE_URL+'/img/del-mark.12x12.png">'+'<button class="text selected" value="'+facet+'">'+unescape(label)+"&nbsp;("+numWithCommas(count)+")&nbsp;&#10003;</button></li>")}var maxOpt=factor*dblp.tocpage.MAX_OPTIONS_TO_SHOW+1;if(maxOpt>sent)maxOpt=sent;for(var i=0;i<maxOpt;i++){var facet=completion[i].text.substring(":facet:access:".length).trim();var label=facet.replace(/_/g," ").trim();var count=completion[i]["@dc"];if(!mod.RS.accessSet.contains(facet)){options.append('<li class="add"><img class="mark" src="'+dblp.BASE_URL+'/img/add-mark.12x12.png">'+'<button class="text" value="'+facet+'">'+unescape(label)+"&nbsp;("+numWithCommas(count)+")</button></li>")}}options.find("li.add").find("button").click(function(){if(panel.data("queryMutex")){return false}else{var facet=$(this).prop("value");console.debug("clicked",facet);mod.RS.accessSet.add(facet);var success=filter();return success}});options.find("li.del").find("button").click(function(){if(panel.data("queryMutex")){return false}else{var facet=$(this).prop("value");console.debug("clicked",facet);mod.RS.accessSet.remove(facet);var success=filter();return success}});if(!mod.RS.accessSet.isEmpty()||sent>0){options.show();if(parseInt(total)>maxOpt){var excess=parseInt(total)-sent;var label=numWithCommas(excess)+" more options";if(excess==1)label="1 more option";moreOptions.html('<li class="more"><button class="text"><em>'+label+"</em></button></li>");moreOptions.find("li.more").click(function(){updateRefineByAccess(dblp.tocpage.OPTIONS_TO_SHOW_GROWTH_RATE*factor)});moreOptions.show()}noOptions.hide()}else{options.hide();moreOptions.hide();noOptions.show()}}).fail(function(jqXHR,textStatus,errorThrown){console.error("access: ["+textStatus+"]",errorThrown);error.show()}).always(function(){console.info("done updating refine-by-access options");waiting.hide();panel.data("lockBreakers").remove(lockBreaker);clearTimeout(lockBreaker)})}function update(){console.debug("start updating refine options");updateTopicCloud();updateRefineByAuthor();updateRefineByInst();updateRefineByAccess();console.info("done updating refine options")}function reset(){console.debug("resetting filter view to full list");let panel=$("#tocpage-refine");let publLists=$(".publ-list");publLists.invisible();publLists.parent().find(".waiting").show();mod.RS.reset();panel.find(".notifier").invisible();panel.find("#record-info").text("showing all");panel.find(".refine-by.query .clear").hide();panel.find(".refine-by.query .icon").invisible();panel.find(".refine-by.query input").val("");update();publLists.find("li.year").show();publLists.find("li.entry").show();publLists.parent().find(".no-pub").hide();publLists.parent().find(".waiting").hide();publLists.visible();panel.data("queryMutex",false)}function filterLinkUpdate(event,apipath,params){if(params==undefined)params="";switch(event.which){case 1:window.location.href=dblp.BASE_URL+apipath+"?q="+mod.RS.getPublQuery()+params;return false;case 2:window.open(dblp.BASE_URL+apipath+"?q="+mod.RS.getPublQuery()+params,"_blank");return false;default:return true}}function filter(){console.debug("start filtering publ list");let panel=$("#tocpage-refine");let notifier=panel.find(".notifier");let publLists=$(".publ-list");if(panel.data("queryMutex")){console.warn("filtering already in process, abort ajax");return false}else panel.data("queryMutex",true);if(!mod.RS.isActive()){console.debug("no constraints for filter, abort ajax");reset();return true}publLists.invisible();publLists.parent().find(".waiting").show();let lockBreaker=setTimeout(function(){console.error("filter: received timeout while calling ajax");clearLockBreakers();reset()},7e3);panel.data("lockBreakers").add(lockBreaker);let url=dblp.CS_PUBLS_API_URL;let data={q:mod.RS.getPublQuery(),p:2,h:1e3,c:0,format:"jsonp"};console.debug("calling: ",urldata(url,data));$.ajax({url:url,type:"GET",data:data,dataType:"jsonp"}).done(function(data,textStatus,jqXHR){let hit=data.result.hits.hit;let total=data.result.hits["@total"];let sent=data.result.hits["@sent"];console.info("retrieving",sent,"of",total,"hits");console.debug("result",data.result);let publs=new buckets.Set;let record,key,i;for(let i=0;i<sent;i++){if("urlpt"in hit[i].info){publs.add(hit[i].info["urlpt"])}}let nonEmpties=new buckets.Set(function(obj){return obj.find("header").attr("id")});$.when().then(function(){publLists.find("li.year").hide();publLists.find("li.no-pub").show()}).then(function(){publLists.find("li.entry").each(function(){if(publs.contains($(this).attr("id"))){$(this).show();$(this).prevAll("li.year:first").show();nonEmpties.add($(this).parent().parent().parent())}else $(this).hide()})}).then(function(){nonEmpties.forEach(function(ulElement){ulElement.find("li.no-pub").hide()})}).then(function(){panel.find("#record-info").text("zoomed in on "+numWithCommas(total)+" of");notifier.find("#record-count").text(numWithCommas(total));let constraint;let summary=notifier.find("#refine-info-summary");summary.empty();if(mod.RS.queryInput.val().trim().length!=0){let escapedInput=encoder.htmlEncode(mod.RS.queryInput.val().trim());summary.append("<li>must match prefix query <em>&quot;"+escapedInput+"&quot;</em></li>")}constraint=mod.RS.authorSet.toArray();for(let i=0;i<constraint.length;i++){let facet=constraint[i].trim();let label=facet.replace(/_/g," ").trim();summary.append("<li>must involve <em>"+unescape(label)+"</em></li>")}constraint=mod.RS.accessSet.toArray();for(let i=0;i<constraint.length;i++){let facet=constraint[i].trim();let label=facet.replace(/_/g," ").trim();summary.append("<li>must be <em>"+unescape(label)+" access</em></li>")}let csLink=notifier.find("#refine-info-cs-link");csLink.unbind("mouseup");csLink.on("mouseup",function(event){filterLinkUpdate(event,"/search/publ")});let xmlLink=notifier.find("#refine-export-xml-link");xmlLink.unbind("mouseup");xmlLink.on("mouseup",function(event){filterLinkUpdate(event,"/search/publ/api","&h=1000&format=xml")});let jsonLink=notifier.find("#refine-export-json-link");jsonLink.unbind("mouseup");jsonLink.on("mouseup",function(event){filterLinkUpdate(event,"/search/publ/api","&h=1000&format=json")});let jsonpLink=notifier.find("#refine-export-jsonp-link");jsonpLink.unbind("mouseup");jsonpLink.on("mouseup",function(event){filterLinkUpdate(event,"/search/publ/api","&h=1000&format=jsonp")});let bibtexLink=notifier.find("#refine-export-bibtex-link");bibtexLink.unbind("mouseup");bibtexLink.on("mouseup",function(event){filterLinkUpdate(event,"/search/publ/bibtex")});let keysLink=notifier.find("#refine-export-keys-link");keysLink.unbind("mouseup");keysLink.on("mouseup",function(event){filterLinkUpdate(event,"/search/publ/hk")})})}).fail(function(jqXHR,textStatus,errorThrown){console.error("filter: ["+textStatus+"]",errorThrown)}).always(function(){console.info("done filtering publ list");notifier.visible();publLists.parent().find(".waiting").hide();publLists.visible();panel.data("lockBreakers").remove(lockBreaker);clearTimeout(lockBreaker);panel.data("queryMutex",false);update()});return true}function initTopicCloud(){console.debug("start initializing topic cloud");let newHtml='<div class="refine-by topic-cloud">'+'<div class="wordcloud"></div>'+"<p><small><em>(currently stemmed word rumps only)</em></small></p>"+"</div>";$("#tocpage-refine").find(".hide-body").append(newHtml);$(".refine-by.topic-cloud .wordcloud").on("click","div",function(){let input=$(".refine-by.query input");if(input.val().trim().length==0)input.val($(this).text());else input.val(input.val().replace(/ +$/,"")+" "+$(this).text());$(".refine-by.query img.clear").show();$(".refine-by.query img.icon").visible();input.get(0).focus();filter()});updateTopicCloud();console.info("done initializing topic cloud")}function initRefineByQuery(){console.debug("start initializing refine-by-query options");let newHtml='<div class="refine-by query">'+"<p><b>refine by search term</b></p>"+"<div><span><input /></span>"+'<img class="icon" title="filter active" alt="filter active" src="'+dblp.BASE_URL+'/img/filter-mark.12x12.png"></div>'+"</div>";$("#tocpage-refine").find(".hide-body").append(newHtml);let panel=$("#tocpage-refine");let byQuery=panel.find(".refine-by.query");let input=byQuery.find("input");let icon=byQuery.find("img.icon");mod.RS.queryInput=input;byQuery.show();icon.invisible();input.css("width",input.innerWidth()-16+"px");input.css("border-width","1px");input.css("padding","1px 20px 1px 1px");input.after('<img class="clear" src="'+dblp.BASE_URL+'/img/clear-mark.medium.16x16.png" alt="" title="clear"></img>');let clear=byQuery.find(".clear");clear.parent("span").css("position","relative");clear.css("position","absolute");clear.css("cursor","pointer");clear.css("top","50%");clear.css("margin-top","-9px");clear.css("right","4px");clear.css("z-index","1");if(input.val().trim().length>0)clear.show();else clear.hide();clear.click(function(){clear.hide();input.val("");input.get(0).focus();filter()});input.on("input",function(){let qlen=$(this).val().trim().length;if(qlen===0){input.css("border-width","1px");input.css("padding","1px 20px 1px 1px");clear.hide();icon.invisible()}else{input.css("border-width","2px");input.css("padding","0px 19px 0px 0px");clear.show();icon.visible()}clearTimeout(panel.data("queryTimer"));var queryTimer=setTimeout(filter,dblp.UX_TYPING_QUERY_DELAY_MSECS(qlen));panel.data("queryTimer",queryTimer)});console.info("done initializing refine-by-year options")}function initRefineByAuthor(){console.debug("start initializing refine-by-author options");var newHtml='<div class="refine-by author">'+"<p><b>refine by author</b></p>"+'<ul class="options"></ul>'+'<ul class="more-options"><li class="more"><button class="text"><em>'+"more options</em></button></li></ul>"+'<ul class="no-options"><li><i>no options</i></li></ul>'+'<ul class="waiting"><li><img src="'+dblp.BASE_URL+'/img/waiting.anim.gif" /></li></ul>'+'<ul class="error"><li><i>temporarily not available</i></li></ul>'+"</div>";$("#tocpage-refine").find(".hide-body").append(newHtml);var panel=$("#tocpage-refine");var byAuthor=panel.find(".refine-by.author");var options=byAuthor.find(".options");var moreOptions=byAuthor.find(".more-options");var noOptions=byAuthor.find(".no-options");var waiting=byAuthor.find(".waiting");var error=byAuthor.find(".error");options.hide();moreOptions.hide();noOptions.show();waiting.hide();error.hide();byAuthor.show();updateRefineByAuthor();console.info("done initializing refine-by-author options")}function initRefineByInst(){console.debug("start initializing refine-by-inst options");var newHtml='<div class="refine-by inst">'+"<p><b>refine by institution</b>&nbsp;"+'<img src="'+dblp.BASE_URL+'/img/faq-mark.dark.12x12.png" '+'title="Please note:\n&#9642; This facet is still work in progress.\n'+"&#9642; Affiliation data for publications is still rather incomplete.\n"+'&#9642; Strings may not always be mapped successfully to affiliation entities."></p>'+'<ul class="options"></ul>'+'<ul class="more-options"><li class="more"><button class="text"><em>'+"more options</em></button></li></ul>"+'<ul class="no-options"><li><i>no options</i></li></ul>'+'<ul class="waiting"><li><img src="'+dblp.BASE_URL+'/img/waiting.anim.gif" /></li></ul>'+'<ul class="error"><li><i>temporarily not available</i></li></ul>'+"</div>";$("#tocpage-refine").find(".hide-body").append(newHtml);var panel=$("#tocpage-refine");var byInst=panel.find(".refine-by.inst");var options=byInst.find(".options");var moreOptions=byInst.find(".more-options");var noOptions=byInst.find(".no-options");var waiting=byInst.find(".waiting");var error=byInst.find(".error");options.hide();moreOptions.hide();noOptions.show();waiting.hide();error.hide();byInst.show();updateRefineByInst();console.info("done initializing refine-by-inst options")}function initRefineByAccess(){console.debug("start initializing refine-by-access options");var newHtml='<div class="refine-by access">'+"<p><b>refine by access</b>&nbsp;"+'<img src="'+dblp.BASE_URL+'/img/faq-mark.dark.12x12.png" '+'title="Please note:\n&#9642; This facet is still work in progress.\n'+'&#9642; Open access information for publications is still rather incomplete."></p>'+'<ul class="options"></ul>'+'<ul class="more-options"><li class="more"><button class="text"><em>'+"more options</em></button></li></ul>"+'<ul class="no-options"><li><i>no options</i></li></ul>'+'<ul class="waiting"><li><img src="'+dblp.BASE_URL+'/img/waiting.anim.gif" /></li></ul>'+'<ul class="error"><li><i>temporarily not available</i></li></ul>'+"</div>";$("#tocpage-refine").find(".hide-body").append(newHtml);var panel=$("#tocpage-refine");var byAccess=panel.find(".refine-by.access");var options=byAccess.find(".options");var moreOptions=byAccess.find(".more-options");var noOptions=byAccess.find(".no-options");var waiting=byAccess.find(".waiting");var error=byAccess.find(".error");options.hide();moreOptions.hide();noOptions.show();waiting.hide();error.hide();byAccess.show();updateRefineByAccess();console.info("done initializing refine-by-access options")}mod.initRefine=function(){if($("#tocpage-refine").length==0)return;console.debug("start initializing toc page filter elements");if($(".publ-list li.entry").length==0){$("#tocpage-refine").hide();return}let panel=$("#tocpage-refine");let notifier=panel.find(".notifier");notifier.invisible();panel.data("queryMutex",false);panel.data("lockBreakers",new buckets.Set);notifier.find("#reset-refinements").click(function(){if(panel.data("queryMutex"))return false;reset();update()});let url=dblp.CS_PUBLS_API_URL;let data={q:mod.RS.getPublQuery(),p:2,h:0,c:0,format:"jsonp"};console.debug("calling:",urldata(url,data));$.ajax({url:url,type:"GET",data:data,dataType:"jsonp"}).done(function(data,textStatus,jqXHR){let total=data.result.hits["@total"];console.info("retrieving a maximum of",total,"hits");notifier.find("#max-record-count").text(numWithCommas(total));notifier.find("#record-count").text(numWithCommas(total));panel.find("#max-record-info").text(numWithCommas(total));$(".publ-list").each(function(){$(this).append('<li class="no-pub"><em>no results</em></li>');$(this).find(".no-pub").hide();$(this).before('<p class="waiting"><img src="'+dblp.BASE_URL+'/img/waiting.anim.gif" /></p>');$(this).parent().find(".waiting").hide()});if(dblp.TEAM_MODE_ENABLED||dblp.LEY_MODE_ENABLED||dblp.MRA_MODE_ENABLED)initTopicCloud();initRefineByQuery();initRefineByAuthor();if(dblp.TEAM_MODE_ENABLED||dblp.LEY_MODE_ENABLED||dblp.MRA_MODE_ENABLED||dblp.BETA_INST_MODE_ENABLED)initRefineByInst();initRefineByAccess();if(mod.RS.isActive())filter()}).fail(function(jqXHR,textStatus,errorThrown){console.error("venue: ["+textStatus+"]",errorThrown);notifier.find("#max-record-count").text("??");notifier.find("#record-count").text("??");panel.find("#max-record-info").text("??");panel.find(".hide-body").append('<p><i class="warning">'+"Service temporarily not available.</i></p>"+"<p>Please try again later.</p>")}).always(function(){console.info("done initializing toc page filter elements")})};mod.init=function(){console.debug("start initializing tocpage functions");mod.initRefine();console.debug("done initializing tocpage functions")}})(dblp.tocpage);$(document).ready(dblp.tocpage.init());
